<html>
<head>
  <title>Login Experiment</title>
    <style type="text/css">
      @import "http://ajax.googleapis.com/ajax/libs/dojo/1.4.1/dojo/resources/dojo.css";
      @import "http://ajax.googleapis.com/ajax/libs/dojo/1.4.1/dijit/themes/tundra/tundra.css";
    </style>
    <script type="text/javascript">
        var djConfig = {
            isDebug: false,
            parseOnLoad: true,
            baseUrl: './',
            modulePaths: {'myapp' : 'widgets'}
        };
    </script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/dojo/1.4.1/dojo/dojo.xd.js"></script>

  <style type="text/css">
    #gridNode {
       width: 400px;
       height: 200px;
    }
  </style>

  <script type="text/javascript" src="/libs/uow/trace.js"></script>
  <script type="text/javascript" src="/libs/uow.js"></script>

  <script type="text/javascript">
    dojo.require('dijit.form.Button');

    dojo.ready(function() {
        dojo.connect(dijit.byId('buttonOne'), 'onClick', function() {
            console.log('clicked the button');
            uow.triggerLogin().addCallback(function(arg) {
                console.log('callback', arg);
                if (arg.flag == 'ok') {
                    dojo.byId('welcome').innerHTML = 'Welcome ' + arg.user.first_name;
                } else {
                    dojo.byId('welcome').innerHTML = 'Login failed.';
                }
            }).addErrback(function(arg) {
                console.log('errback', arg);
            });
        });
    });

  </script>
</head>
<body class="tundra">
  <button id="buttonOne" dojoType="dijit.form.Button" type="button">
    Login
  </button>
  <p id="welcome"></p>
</body>
</html>

